<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Unit Checked Arithmetic via Unitful.jl ¬∑ The SciML Tutorials</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://docs.sciml.ai/SciMLTutorialsOutput/stable/type_handling/03-unitful/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="The SciML Tutorials logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">The SciML Tutorials</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">SciMLTutorials.jl: Tutorials for Scientific Machine Learning (SciML) and Equation Solvers</a></li><li><span class="tocitem">Ordinary Differential Equation (ODE) Examples</span><ul><li><a class="tocitem" href="../../odes/01-ode_minmax/">Finding Maxima and Minima of Ordinary Differential Equation Solutions</a></li></ul></li><li><span class="tocitem">Special Analyses of ODEs</span><ul><li><a class="tocitem" href="../02-uncertainties/">Numbers with Uncertainties</a></li><li class="is-active"><a class="tocitem" href>Unit Checked Arithmetic via Unitful.jl</a><ul class="internal"><li><a class="tocitem" href="#Using-Unitful"><span>Using Unitful</span></a></li><li><a class="tocitem" href="#Using-Unitful-with-DifferentialEquations.jl"><span>Using Unitful with DifferentialEquations.jl</span></a></li><li><a class="tocitem" href="#Appendix"><span>Appendix</span></a></li></ul></li></ul></li><li><span class="tocitem">Mixing Julia Types with Differential Equations</span><ul><li><a class="tocitem" href="../../models/01-classical_physics/">Classical Physics Models</a></li><li><a class="tocitem" href="../../models/02-conditional_dosing/">Conditional Dosing Pharmacometric Example</a></li><li><a class="tocitem" href="../../models/03-kepler_problem/">Kepler Problem</a></li><li><a class="tocitem" href="../../models/04-spiking_neural_systems/">Spiking Neural Systems</a></li><li><a class="tocitem" href="../../models/05-outer_solar_system/">The Outer Solar System</a></li></ul></li><li><span class="tocitem">Inference and Parameter Estimation on ODEs</span><ul><li><a class="tocitem" href="../../model_inference/01-pendulum_bayesian_inference/">Bayesian Inference on a Pendulum using DiffEqBayes.jl</a></li><li><a class="tocitem" href="../../model_inference/02-monte_carlo_parameter_estim/">Monte Carlo Parameter Estimation From Data</a></li></ul></li><li><span class="tocitem">Analyzing Jump Process Equations</span><ul><li><a class="tocitem" href="../../exercises/01-workshop_exercises/">SciML Workshop Exercises</a></li><li><a class="tocitem" href="../../exercises/02-workshop_solutions/">SciML Workshop Exercise Solutions</a></li></ul></li><li><span class="tocitem">Advanced ODE Examples</span><ul><li><a class="tocitem" href="../../advanced/01-beeler_reuter/">An Implicit/Explicit CUDA-Accelerated Solver for the 2D Beeler-Reuter Model</a></li><li><a class="tocitem" href="../../advanced/02-diffusion_implicit_heat_equation/">Solving the heat equation with diffusion-implicit time-stepping</a></li></ul></li><li><span class="tocitem">Uncertainty Quantification on ODEs</span><ul><li><a class="tocitem" href="../../perturbation/01-perturbation_algebraic/">Mixed Symbolic/Numerical Methods for Perturbation Theory - Algebraic Equations</a></li><li><a class="tocitem" href="../../perturbation/02-perturbation_differential/">Mixed Symbolic/Numerical Methods for Perturbation Theory - Differential Equations</a></li></ul></li><li><span class="tocitem">Symbolic-Numeric Approaches</span><ul><li><a class="tocitem" href="../../jumps/spatial/">Tutorial on using spatial SSAs in DiffEqJump</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Special Analyses of ODEs</a></li><li class="is-active"><a href>Unit Checked Arithmetic via Unitful.jl</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Unit Checked Arithmetic via Unitful.jl</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/SciML/SciMLTutorialsOutput/blob/main/docs/src/type_handling/03-unitful.md" title="Edit on GitHub"><span class="docs-icon fab">ÔÇõ</span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Unit-Checked-Arithmetic-via-Unitful.jl"><a class="docs-heading-anchor" href="#Unit-Checked-Arithmetic-via-Unitful.jl">Unit Checked Arithmetic via Unitful.jl</a><a id="Unit-Checked-Arithmetic-via-Unitful.jl-1"></a><a class="docs-heading-anchor-permalink" href="#Unit-Checked-Arithmetic-via-Unitful.jl" title="Permalink"></a></h1><p>Units and dimensional analysis are standard tools across the sciences for checking the correctness of your equation. However, most ODE solvers only allow for the equation to be in dimensionless form, leaving it up to the user to both convert the equation to a dimensionless form, punch in the equations, and hopefully not make an error along the way.</p><p>DifferentialEquations.jl allows for one to use Unitful.jl to have unit-checked arithmetic natively in the solvers. Given the dispatch implementation of the Unitful, this has little overhead.</p><h2 id="Using-Unitful"><a class="docs-heading-anchor" href="#Using-Unitful">Using Unitful</a><a id="Using-Unitful-1"></a><a class="docs-heading-anchor-permalink" href="#Using-Unitful" title="Permalink"></a></h2><p>To use Unitful, you need to have the package installed. Then you can add units to your variables. For example:</p><pre><code class="language-julia hljs">using Unitful
t = 1.0u&quot;s&quot;</code></pre><pre><code class="nohighlight hljs">1.0 s</code></pre><p>Notice that <code>t</code> is a variable with units in seconds. If we make another value with seconds, they can add</p><pre><code class="language-julia hljs">t2 = 1.02u&quot;s&quot;
t+t2</code></pre><pre><code class="nohighlight hljs">2.02 s</code></pre><p>and they can multiply:</p><pre><code class="language-julia hljs">t*t2</code></pre><pre><code class="nohighlight hljs">1.02 s^2</code></pre><p>You can even do rational roots:</p><pre><code class="language-julia hljs">sqrt(t)</code></pre><pre><code class="nohighlight hljs">1.0 s^1/2</code></pre><p>Many operations work. These operations will check to make sure units are correct, and will throw an error for incorrect operations:</p><pre><code class="language-julia hljs">t + sqrt(t)</code></pre><pre><code class="nohighlight hljs">Error: DimensionError: 1.0 s and 1.0 s^1/2 are not dimensionally compatible.</code></pre><h2 id="Using-Unitful-with-DifferentialEquations.jl"><a class="docs-heading-anchor" href="#Using-Unitful-with-DifferentialEquations.jl">Using Unitful with DifferentialEquations.jl</a><a id="Using-Unitful-with-DifferentialEquations.jl-1"></a><a class="docs-heading-anchor-permalink" href="#Using-Unitful-with-DifferentialEquations.jl" title="Permalink"></a></h2><p>Just like with other number systems, you can choose the units for your numbers by simply specifying the units of the initial condition and the timestep. For example, to solve the linear ODE where the variable has units of Newton&#39;s and <code>t</code> is in Seconds, we would use:</p><pre><code class="language-julia hljs">using DifferentialEquations
f = (y,p,t) -&gt; 0.5*y
u0 = 1.5u&quot;N&quot;
prob = ODEProblem(f,u0,(0.0u&quot;s&quot;,1.0u&quot;s&quot;))
sol = solve(prob,Tsit5())</code></pre><pre><code class="nohighlight hljs">Error: DimensionError: N s^-1 and 0.75 N are not dimensionally compatible.</code></pre><p>Notice that we recieved a unit mismatch error. This is correctly so! Remember that for an ODE:</p><p class="math-container">\[\frac{dy}{dt} = f(t,y)\]</p><p>we must have that <code>f</code> is a rate, i.e. <code>f</code> is a change in <code>y</code> per unit time. So we need to fix the units of <code>f</code> in our example to be <code>N/s</code>. Notice that we then do not receive an error if we do the following:</p><pre><code class="language-julia hljs">f = (y,p,t) -&gt; 0.5*y/3.0u&quot;s&quot;
prob = ODEProblem(f,u0,(0.0u&quot;s&quot;,1.0u&quot;s&quot;))
sol = solve(prob,Tsit5())</code></pre><pre><code class="nohighlight hljs">retcode: Success
Interpolation: specialized 4th order &quot;free&quot; interpolation
t: 3-element Array{Unitful.Quantity{Float64,ùêì,Unitful.FreeUnits{(s,),ùêì,nothing}},1}:
                 0.0 s
 0.14311598261241779 s
                 1.0 s
u: 3-element Array{Unitful.Quantity{Float64,ùêã ùêå ùêì^-2,Unitful.FreeUnits{(N,),ùêã ùêå ùêì^-2,nothing}},1}:
                1.5 N
 1.5362091208988309 N
 1.7720406194871123 N</code></pre><p>This gives a a normal solution object. Notice that the values are all with the correct units:</p><pre><code class="language-julia hljs">print(sol[:])</code></pre><pre><code class="nohighlight hljs">Unitful.Quantity{Float64,ùêã ùêå ùêì^-2,Unitful.FreeUnits{(N,),ùêã ùêå ùêì^-2,nothing}}[1.5 N, 1.5362091208988309 N, 1.7720406194871123 N]</code></pre><p>We can plot the solution by removing the units:</p><pre><code class="language-julia hljs">using Plots
gr()
plot(ustrip(sol.t),ustrip(sol[:]),lw=3)</code></pre><p><img src="../figures/03-unitful_9_1.png" alt/></p><h2 id="Appendix"><a class="docs-heading-anchor" href="#Appendix">Appendix</a><a id="Appendix-1"></a><a class="docs-heading-anchor-permalink" href="#Appendix" title="Permalink"></a></h2><p>This tutorial is part of the SciMLTutorials.jl repository, found at: <a href="https://github.com/SciML/SciMLTutorials.jl">https://github.com/SciML/SciMLTutorials.jl</a>.  For more information on doing scientific machine learning (SciML) with open source software, check out <a href="https://sciml.ai/">https://sciml.ai/</a>.</p><p>To locally run this tutorial, do the following commands:</p><pre><code class="nohighlight hljs">using SciMLTutorials
SciMLTutorials.weave_file(&quot;type_handling&quot;,&quot;03-unitful.jmd&quot;)</code></pre><p>Computer Information:</p><pre><code class="nohighlight hljs">Julia Version 1.4.2
Commit 44fa15b150* (2020-05-23 18:35 UTC)
Platform Info:
  OS: Linux (x86_64-pc-linux-gnu)
  CPU: Intel(R) Core(TM) i7-9700K CPU @ 3.60GHz
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-8.0.1 (ORCJIT, skylake)
Environment:
  JULIA_LOAD_PATH = /builds/JuliaGPU/DiffEqTutorials.jl:
  JULIA_DEPOT_PATH = /builds/JuliaGPU/DiffEqTutorials.jl/.julia
  JULIA_CUDA_MEMORY_LIMIT = 2147483648
  JULIA_NUM_THREADS = 8
</code></pre><p>Package Information:</p><pre><code class="nohighlight hljs">Status `/builds/JuliaGPU/DiffEqTutorials.jl/tutorials/type_handling/Project.toml`
[7e558dbc-694d-5a72-987c-6f4ebed21442] ArbNumerics 1.2.1
[55939f99-70c6-5e9b-8bb0-5071ed7d61fd] DecFP 1.0.0
[abce61dc-4473-55a0-ba07-351d65e31d42] Decimals 0.4.1
[0c46a032-eb83-5123-abaf-570d42b7fbaa] DifferentialEquations 6.15.0
[497a8b3b-efae-58df-a0af-a86822472b78] DoubleFloats 1.1.13
[eff96d63-e80a-5855-80a2-b1b0885c5ab7] Measurements 2.3.0
[1dea7af3-3e70-54e6-95c3-0bf5283fa5ed] OrdinaryDiffEq 5.43.0
[91a5bcdd-55d7-5caf-9e0b-520d859cae80] Plots 1.6.12
[1986cc42-f94f-5a68-af5c-568840ba703d] Unitful 1.5.0</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../02-uncertainties/">¬´ Numbers with Uncertainties</a><a class="docs-footer-nextpage" href="../../models/01-classical_physics/">Classical Physics Models ¬ª</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Saturday 3 December 2022 00:55">Saturday 3 December 2022</span>. Using Julia version 1.8.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
